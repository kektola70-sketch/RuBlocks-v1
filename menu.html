<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rublocks</title>
    <link rel="stylesheet" href="style.css">
    <!-- Three.js –¥–ª—è 3D –∏–≥—Ä—ã -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.160.0/build/three.module.js"
        }
      }
    </script>
</head>
<body>

    <!-- –ò–ì–†–û–í–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† (–°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div id="gameContainer">
        <div id="gameUI">
            <button id="exitGameBtn">–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã</button>
            <span id="gameStatusText" style="color:white; margin-left:10px;">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        <!-- –°—é–¥–∞ Three.js –≤—Å—Ç–∞–≤–∏—Ç Canvas -->
    </div>

    <!-- –í–•–û–î–Ø–©–ò–ô –ó–í–û–ù–û–ö -->
    <div id="incomingCallScreen" class="incoming-call-screen hidden">
        <img src="" id="incCallerAvatar" class="caller-large-avatar">
        <h2 id="incCallerName" style="font-size:24px;">User</h2>
        <p>–í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫...</p>
        <div class="call-actions">
            <button id="btnAnswer" class="btn-round-large btn-accept">üìû</button>
            <button id="btnDecline" class="btn-round-large btn-decline">‚úñ</button>
        </div>
    </div>

    <!-- –ê–ö–¢–ò–í–ù–´–ô –ó–í–û–ù–û–ö -->
    <div id="activeCallScreen" class="active-call-screen hidden">
        <div class="call-header">
            <button id="minimizeCallBtn" class="minimize-btn">‚åÑ</button>
            <h2>–ó–≤–æ–Ω–æ–∫</h2>
            <div style="width:24px;"></div>
        </div>
        
        <!-- –ï—Å–ª–∏ —Å–≤–µ—Ä–Ω—É—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç—Ç–æ -->
        <div class="mini-info" style="display:none;">
            <span style="color:white;">üü¢ –í –∑–≤–æ–Ω–∫–µ</span>
            <button id="expandCallBtn" style="background:none; border:none; color:white;">‚åÉ</button>
        </div>

        <div class="call-grid" id="callParticipantsGrid">
            <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ -->
            <div class="call-participant">
                <img src="" id="myCallAvatar">
                <span>–Ø</span>
                <span class="mic-status">üé§</span>
            </div>
            <div class="call-participant">
                <img src="" id="otherCallAvatar">
                <span id="otherCallName">...</span>
                <span class="mic-status">üé§</span>
            </div>
        </div>

        <div class="call-controls-bar">
            <button id="toggleMicBtn" class="control-btn">üé§</button>
            <button id="toggleChatBtn" class="control-btn">üí¨</button>
            <button id="btnHangup" class="control-btn hangup">üìû</button>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ï –ú–ï–ù–Æ (–ö–∞–∫ —Ä–∞–Ω—å—à–µ) -->
    <header class="top-bar">
        <div class="user-info">
            <div class="avatar-circle"><img src="" id="myAvatar"></div>
            <div class="user-text">
                <h2 id="myUsername">...</h2>
                <span class="user-id-tag" id="myUserId">@loading</span>
            </div>
        </div>
    </header>

    <section class="connections-section">
        <h3>Connections</h3>
        <div class="connections-list">
            <div class="friend-card add-card" id="openSearchBtn"><div class="plus-icon">+</div><span>–ü–æ–∏—Å–∫</span></div>
            <div id="friendsContainer" style="display:flex; gap:10px;"></div>
        </div>
    </section>

    <!-- –í–´–ë–û–† –ò–ì–†–´ -->
    <div id="gameSelectorModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header"><h3>–í—ã–±—Ä–∞—Ç—å –ü–ª–µ–π—Å</h3><button id="closeGameSel">‚úï</button></div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                <div class="game-card" data-game="pizza">
                    <img src="https://cdn-icons-png.flaticon.com/512/3132/3132693.png">
                    <h4>–ü–∏—Ü—Ü–µ—Ä–∏—è</h4>
                </div>
                <div class="game-card" data-game="obby">
                    <img src="https://cdn-icons-png.flaticon.com/512/3062/3062634.png">
                    <h4>Obby</h4>
                </div>
            </div>
            <div style="margin-top:20px; display:flex; flex-direction:column; gap:10px;">
                <button id="playTogetherBtn" class="add-conn-btn" style="padding:15px;" disabled>üéÆ –ò–≥—Ä–∞—Ç—å —Å –¥—Ä—É–≥–æ–º (–í –∑–≤–æ–Ω–∫–µ)</button>
                <button id="playSoloBtn" class="small-btn" style="background:#444; padding:15px;">üë§ –ò–≥—Ä–∞—Ç—å –æ–¥–Ω–æ–º—É</button>
            </div>
        </div>
    </div>

    <!-- –°–ö–†–´–¢–´–ô –ê–£–î–ò–û –≠–õ–ï–ú–ï–ù–¢ –î–õ–Ø –ó–í–û–ù–ö–ê -->
    <audio id="remoteAudio" autoplay></audio>

    <script type="module" src="menu.js"></script>
    <script type="module" src="game_pizza.js"></script>
</body>
</html>